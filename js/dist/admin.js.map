{"version":3,"file":"admin.js","mappings":"MACA,IAAIA,EAAsB,CCA1BA,EAAyBC,IACxB,IAAIC,EAASD,GAAUA,EAAOE,WAC7B,IAAOF,EAAiB,QACxB,IAAM,EAEP,OADAD,EAAoBI,EAAEF,EAAQ,CAAEG,EAAGH,IAC5BA,CAAM,ECLdF,EAAwB,CAACM,EAASC,KACjC,IAAI,IAAIC,KAAOD,EACXP,EAAoBS,EAAEF,EAAYC,KAASR,EAAoBS,EAAEH,EAASE,IAC5EE,OAAOC,eAAeL,EAASE,EAAK,CAAEI,YAAY,EAAMC,IAAKN,EAAWC,IAE1E,ECNDR,EAAwB,CAACc,EAAKC,IAAUL,OAAOM,UAAUC,eAAeC,KAAKJ,EAAKC,GCClFf,EAAyBM,IACH,oBAAXa,QAA0BA,OAAOC,aAC1CV,OAAOC,eAAeL,EAASa,OAAOC,YAAa,CAAEC,MAAO,WAE7DX,OAAOC,eAAeL,EAAS,aAAc,CAAEe,OAAO,GAAO,G,qDCL9D,MAAM,EAA+BC,OAAOC,IAAIV,IAAI,OAAQ,a,aCA5D,MAAM,EAA+BS,OAAOC,IAAIV,IAAI,OAAQ,iBCAtD,EAA+BS,OAAOC,IAAIV,IAAI,OAAQ,iC,aCA5D,MAAM,EAA+BS,OAAOC,IAAIV,IAAI,OAAQ,c,aCA5D,MAAM,EAA+BS,OAAOC,IAAIV,IAAI,OAAQ,4B,aCA5D,SAASW,EAAQf,GAGf,OAAOe,EAAU,mBAAqBL,QAAU,iBAAmBA,OAAOM,SAAW,SAAUhB,GAC7F,cAAcA,CAChB,EAAI,SAAUA,GACZ,OAAOA,GAAK,mBAAqBU,QAAUV,EAAEiB,cAAgBP,QAAUV,IAAMU,OAAOH,UAAY,gBAAkBP,CACpH,EAAGe,EAAQf,EACb,CCPA,SAASkB,EAAgBC,EAAGC,EAAGC,GAC7B,OAAQD,ECAV,SAAuBC,GACrB,IAAIC,ECFN,SAAqBD,GACnB,GAAI,UAAYN,EAAQM,KAAOA,EAAG,OAAOA,EACzC,IAAIF,EAAIE,EAAEX,OAAOa,aACjB,QAAI,IAAWJ,EAAG,CAChB,IAAIG,EAAIH,EAAEV,KAAKY,EAAGD,UAClB,GAAI,UAAYL,EAAQO,GAAI,OAAOA,EACnC,MAAM,IAAIE,UAAU,+CACtB,CACA,OAAyBC,OAAiBJ,EAC5C,CDPUE,CAAYF,GACpB,MAAO,UAAYN,EAAQO,GAAKA,EAAIA,EAAI,EAC1C,CDHcI,CAAcN,MAAOD,EAAIlB,OAAOC,eAAeiB,EAAGC,EAAG,CAC/DR,MAAOS,EACPlB,YAAY,EACZwB,cAAc,EACdC,UAAU,IACPT,EAAEC,GAAKC,EAAGF,CACjB,CGRA,MAAM,EAA+BN,OAAOC,IAAIV,IAAI,OAAQ,0B,aCA5D,MAAM,EAA+BS,OAAOC,IAAIV,IAAI,OAAQ,+B,aCA5D,MAAM,EAA+BS,OAAOC,IAAIV,IAAI,OAAQ,2B,aCA5D,MAAM,EAA+BS,OAAOC,IAAIV,IAAI,OAAQ,uB,aCA5D,MAAM,EAA+BS,OAAOC,IAAIV,IAAI,OAAQ,yB,aCQ7C,MAAMyB,UAAyB,KAC5C,WAAAZ,GACEa,SAASC,WACTb,EAAgBc,KAAM,YAAQ,GAC9Bd,EAAgBc,KAAM,cAAU,GAChCd,EAAgBc,KAAM,eAAW,GACjCd,EAAgBc,KAAM,qBAAiB,GACvCd,EAAgBc,KAAM,sBAAkB,EAC1C,CACA,MAAAC,CAAOC,GACLJ,MAAMG,OAAOC,GACbF,KAAKG,KAAOH,KAAKI,MAAMD,KACvBH,KAAKK,OAAS,IAAO,IACrBL,KAAKM,SAAU,EACfN,KAAKO,cAAgB,iBAAiBC,IAAI,uBAC1CR,KAAKS,eAAiBT,KAAKG,KAAKO,2BAClC,CACA,SAAAC,GACE,MAAO,gCACT,CACA,KAAAC,GACE,OAAO,eAAeC,MAAM,kCAC9B,CACA,OAAAC,GACE,OAAOC,EAAE,MAAO,CACdJ,UAAW,cACVI,EAAE,MAAO,KAAMA,EAAE,IAAK,KAAM,eAAeF,MAAM,kCAAmC,CACrFG,SAAU,IAAShB,KAAKG,UACpBY,EAAE,IAAM,CACZJ,UAAW,kBACVX,KAAKO,cAAgBQ,EAAE,MAAO,CAC/BJ,UAAW,cACVI,EAAE,WAAY,CACfJ,UAAW,cACX/B,MAAOoB,KAAKK,SACZY,YAAajB,KAAKS,eAAiB,eAAeI,MAAM,kDAAoD,eAAeA,MAAM,kDACjIK,QAAS,IAAS,QAASlB,KAAKK,QAChCc,KAAM,OACF,GAAIJ,EAAE,MAAO,CACjBJ,UAAW,cACV,cAAiB,CAClBA,UAAW,uCACXS,KAAM,SACNd,QAASN,KAAKM,SACb,eAAeO,MAAM,iDAAkD,CACxEG,SAAU,IAAShB,KAAKG,WAE5B,CACA,QAAAkB,CAASlC,GACPA,EAAEmC,iBACFtB,KAAKM,SAAU,EACf,UAAUiB,aAAa,eAAeC,KAAK,CACzCC,OAAQzB,KAAKG,KAAKuB,KAClBrB,OAAQL,KAAKK,WACZsB,KAAK3B,KAAKI,MAAMwB,UAAUC,OAAM,KACjC7B,KAAKM,SAAU,CAAK,GAExB,EAEFzB,OAAOC,IAAIgD,IAAI,kBAAmB,qCAAsCjC,GChEzD,MAAMkC,UAA0B,KAC7C,IAAAC,GACE,OAAOjB,EAAE,IAAQ,CACfkB,KAAM,iBACNC,QAASlC,KAAKmC,YAAYC,KAAKpC,OAC9B,eAAea,MAAM,wDAC1B,CACA,WAAAsB,GACE,MAAM,KACJhC,EAAI,WACJkC,GACErC,KAAKI,MACT,UAAUkC,KAAKzC,EAAkB,CAC/B+B,SAAU,KACRS,EAAaE,OAAOC,SAASC,KAAOJ,EAAaE,OAAOC,SAASE,QAAQ,EAE3EvC,QAEJ,EAEFtB,OAAOC,IAAIgD,IAAI,kBAAmB,sCAAuCC,GCvBzE,MAAM,EAA+BlD,OAAOC,IAAIV,IAAI,OAAQ,oB,aCA5D,MAAM,EAA+BS,OAAOC,IAAIV,IAAI,OAAQ,sB,aCA5D,MAAM,EAA+BS,OAAOC,IAAIV,IAAI,OAAQ,gB,aCC7C,MAAMuE,UAAoB,KACvC,MAAAtC,GACE,OAAO,cAAgB,UAAU5B,KAAKuB,KACxC,EAEFnB,OAAOC,IAAIgD,IAAI,kBAAmB,4BAA6Ba,GCH/D,UAAgB,IAAI,YACnBb,IAAI,cAAea,GAAc,IAAI,WAAa,KAClDC,UAAU,qBAAqBA,UAAU,8BCFpCC,EAAW,GACb,iBAAiBrC,IAAI,wBACvBqC,EAASC,MAAK,IAAI,YAAeC,SAAQ,KAAM,CAC7CA,QAAS,iCACT3B,KAAM,UACN4B,MAAO,eAAenC,MAAM,sDAGhC,YAAmB,GAAc,IAAI,YACpCoC,YAAW,KAAM,CAChBhB,KAAM,iBACNe,MAAO,eAAenC,MAAM,2CAC5BoC,WAAY,2BACV,eAAgBJ,GCbpB,iBAAiBf,IAAI,mBAAmB,MCEtC,IAAAoB,QAAO,cAAwB,mBAAmB,SAAUC,EAAOhD,GACjE,MAAMiD,EAAe,UAAUR,UAAU,WACzCO,EAAMrB,IAAI,cAAef,EAAEgB,EAAmB,CAC5C5B,KAAMA,EACNkC,WAAY,GAAGe,OAAkBjD,EAAKkD,WAE1C,GDPoB,G","sources":["webpack://@fof/impersonate/webpack/bootstrap","webpack://@fof/impersonate/webpack/runtime/compat get default export","webpack://@fof/impersonate/webpack/runtime/define property getters","webpack://@fof/impersonate/webpack/runtime/hasOwnProperty shorthand","webpack://@fof/impersonate/webpack/runtime/make namespace object","webpack://@fof/impersonate/external root \"flarum.reg.get('core', 'admin/app')\"","webpack://@fof/impersonate/external root \"flarum.reg.get('core', 'common/extend')\"","webpack://@fof/impersonate/external root \"flarum.reg.get('core', 'admin/components/UserListPage')\"","webpack://@fof/impersonate/external root \"flarum.reg.get('core', 'common/app')\"","webpack://@fof/impersonate/external root \"flarum.reg.get('core', 'common/components/Button')\"","webpack://@fof/impersonate/./node_modules/flarum-webpack-config/node_modules/@babel/runtime/helpers/esm/typeof.js","webpack://@fof/impersonate/./node_modules/flarum-webpack-config/node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack://@fof/impersonate/./node_modules/flarum-webpack-config/node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","webpack://@fof/impersonate/./node_modules/flarum-webpack-config/node_modules/@babel/runtime/helpers/esm/toPrimitive.js","webpack://@fof/impersonate/external root \"flarum.reg.get('core', 'common/components/Form')\"","webpack://@fof/impersonate/external root \"flarum.reg.get('core', 'common/components/FormModal')\"","webpack://@fof/impersonate/external root \"flarum.reg.get('core', 'common/helpers/username')\"","webpack://@fof/impersonate/external root \"flarum.reg.get('core', 'common/utils/Stream')\"","webpack://@fof/impersonate/external root \"flarum.reg.get('core', 'common/utils/withAttr')\"","webpack://@fof/impersonate/./src/common/components/ImpersonateModal.tsx","webpack://@fof/impersonate/./src/common/components/LoginAsUserButton.tsx","webpack://@fof/impersonate/external root \"flarum.reg.get('core', 'common/extenders')\"","webpack://@fof/impersonate/external root \"flarum.reg.get('core', 'common/models/User')\"","webpack://@fof/impersonate/external root \"flarum.reg.get('core', 'common/Model')\"","webpack://@fof/impersonate/./src/common/models/Impersonate.ts","webpack://@fof/impersonate/./src/common/extend.ts","webpack://@fof/impersonate/./src/admin/extend.ts","webpack://@fof/impersonate/./src/admin/index.ts","webpack://@fof/impersonate/./src/admin/extendUserListPage.tsx"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'admin/app');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/extend');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'admin/components/UserListPage');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/app');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/components/Button');","function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}\nexport { _typeof as default };","import toPropertyKey from \"./toPropertyKey.js\";\nfunction _defineProperty(e, r, t) {\n  return (r = toPropertyKey(r)) in e ? Object.defineProperty(e, r, {\n    value: t,\n    enumerable: !0,\n    configurable: !0,\n    writable: !0\n  }) : e[r] = t, e;\n}\nexport { _defineProperty as default };","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nfunction toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : i + \"\";\n}\nexport { toPropertyKey as default };","import _typeof from \"./typeof.js\";\nfunction toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}\nexport { toPrimitive as default };","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/components/Form');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/components/FormModal');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/helpers/username');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/utils/Stream');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/utils/withAttr');","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport Form from 'flarum/common/components/Form';\nimport app from 'flarum/common/app';\nimport FormModal from 'flarum/common/components/FormModal';\nimport Button from 'flarum/common/components/Button';\nimport username from 'flarum/common/helpers/username';\nimport Stream from 'flarum/common/utils/Stream';\nimport withAttr from 'flarum/common/utils/withAttr';\nexport default class ImpersonateModal extends FormModal {\n  constructor() {\n    super(...arguments);\n    _defineProperty(this, \"user\", void 0);\n    _defineProperty(this, \"reason\", void 0);\n    _defineProperty(this, \"loading\", void 0);\n    _defineProperty(this, \"reasonEnabled\", void 0);\n    _defineProperty(this, \"reasonRequired\", void 0);\n  }\n  oninit(vnode) {\n    super.oninit(vnode);\n    this.user = this.attrs.user;\n    this.reason = Stream('');\n    this.loading = false;\n    this.reasonEnabled = app.initializers.has('fof-moderator-notes');\n    this.reasonRequired = this.user.impersonateReasonRequired();\n  }\n  className() {\n    return 'ImpersonateModal Modal--medium';\n  }\n  title() {\n    return app.translator.trans('fof-impersonate.lib.modal.title');\n  }\n  content() {\n    return m(\"div\", {\n      className: \"Modal-body\"\n    }, m(\"div\", null, m(\"p\", null, app.translator.trans('fof-impersonate.lib.modal.label', {\n      username: username(this.user)\n    }))), m(Form, {\n      className: \"Form--centered\"\n    }, this.reasonEnabled ? m(\"div\", {\n      className: \"Form-group\"\n    }, m(\"textarea\", {\n      className: \"FormControl\",\n      value: this.reason(),\n      placeholder: this.reasonRequired ? app.translator.trans('fof-impersonate.lib.modal.placeholder_required') : app.translator.trans('fof-impersonate.lib.modal.placeholder_optional'),\n      oninput: withAttr('value', this.reason),\n      rows: \"4\"\n    })) : '', m(\"div\", {\n      className: \"Form-group\"\n    }, Button.component({\n      className: 'Button Button--primary Button--block',\n      type: 'submit',\n      loading: this.loading\n    }, app.translator.trans('fof-impersonate.lib.modal.impersonate_username', {\n      username: username(this.user)\n    })))));\n  }\n  onsubmit(e) {\n    e.preventDefault();\n    this.loading = true;\n    app.store.createRecord('impersonate').save({\n      userId: this.user.id(),\n      reason: this.reason()\n    }).then(this.attrs.callback).catch(() => {\n      this.loading = false;\n    });\n  }\n}\nflarum.reg.add('fof-impersonate', 'common/components/ImpersonateModal', ImpersonateModal);","import app from 'flarum/common/app';\nimport Button from 'flarum/common/components/Button';\nimport ImpersonateModal from './ImpersonateModal';\nexport default class LoginAsUserButton extends Button {\n  view() {\n    return m(Button, {\n      icon: \"fas fa-id-card\",\n      onclick: this.loginAsUser.bind(this)\n    }, app.translator.trans('fof-impersonate.lib.user_controls.impersonate_button'));\n  }\n  loginAsUser() {\n    const {\n      user,\n      redirectTo\n    } = this.attrs;\n    app.modal.show(ImpersonateModal, {\n      callback: () => {\n        redirectTo ? window.location.href = redirectTo : window.location.reload();\n      },\n      user\n    });\n  }\n}\nflarum.reg.add('fof-impersonate', 'common/components/LoginAsUserButton', LoginAsUserButton);","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/extenders');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/models/User');","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.reg.get('core', 'common/Model');","import Model from 'flarum/common/Model';\nexport default class Impersonate extends Model {\n  reason() {\n    return Model.attribute('reason').call(this);\n  }\n}\nflarum.reg.add('fof-impersonate', 'common/models/Impersonate', Impersonate);","import Extend from 'flarum/common/extenders';\nimport User from 'flarum/common/models/User';\nimport Impersonate from './models/Impersonate';\nexport default [new Extend.Store() //\n.add('impersonate', Impersonate), new Extend.Model(User) //\n.attribute('canFoFImpersonate').attribute('impersonateReasonRequired')];","import Extend from 'flarum/common/extenders';\nimport app from 'flarum/admin/app';\nimport { default as commonExtend } from '../common/extend';\nconst settings = [];\nif (app.initializers.has('fof-moderator-notes')) {\n  settings.push(new Extend.Admin().setting(() => ({\n    setting: 'fof-impersonate.require_reason',\n    type: 'boolean',\n    label: app.translator.trans('fof-impersonate.admin.settings.require_reason')\n  })));\n}\nexport default [...commonExtend, new Extend.Admin() //\n.permission(() => ({\n  icon: 'fas fa-id-card',\n  label: app.translator.trans('fof-impersonate.admin.permissions.login'),\n  permission: 'fof-impersonate.login'\n}), 'moderate'), ...settings];","import app from 'flarum/admin/app';\nimport extendUserListPage from './extendUserListPage';\nexport { default as extend } from './extend';\napp.initializers.add('fof-impersonate', () => {\n  extendUserListPage();\n});","import app from 'flarum/admin/app';\nimport { extend } from 'flarum/common/extend';\nimport UserListPage from 'flarum/admin/components/UserListPage';\nimport LoginAsUserButton from '../common/components/LoginAsUserButton';\nexport default function extendUserListPage() {\n  extend(UserListPage.prototype, 'userActionItems', function (items, user) {\n    const forumBaseUrl = app.forum.attribute('baseUrl');\n    items.add('impersonate', m(LoginAsUserButton, {\n      user: user,\n      redirectTo: `${forumBaseUrl}/u/${user.slug()}`\n    }));\n  });\n}"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","flarum","reg","_typeof","iterator","constructor","_defineProperty","e","r","t","i","toPrimitive","TypeError","String","toPropertyKey","configurable","writable","ImpersonateModal","super","arguments","this","oninit","vnode","user","attrs","reason","loading","reasonEnabled","has","reasonRequired","impersonateReasonRequired","className","title","trans","content","m","username","placeholder","oninput","rows","type","onsubmit","preventDefault","createRecord","save","userId","id","then","callback","catch","add","LoginAsUserButton","view","icon","onclick","loginAsUser","bind","redirectTo","show","window","location","href","reload","Impersonate","attribute","settings","push","setting","label","permission","extend","items","forumBaseUrl","slug"],"sourceRoot":""}