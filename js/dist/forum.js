(()=>{var o={n:t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return o.d(e,{a:e}),e},d:(t,e)=>{for(var r in e)o.o(e,r)&&!o.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},o:(o,t)=>Object.prototype.hasOwnProperty.call(o,t),r:o=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})}},t={};(()=>{"use strict";o.r(t),o.d(t,{extend:()=>N});const e=flarum.core.compat["common/extend"],r=flarum.core.compat["forum/app"];var n=o.n(r);const a=flarum.core.compat["forum/utils/UserControls"];var s=o.n(a);const i=flarum.core.compat["common/components/Button"];var c=o.n(i);function l(o,t){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,t){return o.__proto__=t,o},l(o,t)}function u(o,t){o.prototype=Object.create(t.prototype),o.prototype.constructor=o,l(o,t)}const d=flarum.core.compat["common/components/Modal"];var p=o.n(d);const f=flarum.core.compat["common/helpers/username"];var h=o.n(f);const v=flarum.core.compat["common/utils/Stream"];var b=o.n(v);const y=flarum.core.compat["common/utils/withAttr"];var g=o.n(y),_=function(o){function t(){for(var t,e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=o.call.apply(o,[this].concat(r))||this).user=void 0,t.reason=void 0,t.loading=void 0,t.reasonEnabled=void 0,t.reasonRequired=void 0,t}u(t,o);var e=t.prototype;return e.oninit=function(t){o.prototype.oninit.call(this,t),this.user=this.attrs.user,this.reason=b()(""),this.loading=!1,this.reasonEnabled=n().initializers.has("fof-moderator-notes"),this.reasonRequired=this.user.impersonateReasonRequired()},e.className=function(){return"ImpersonateModal Modal--medium"},e.title=function(){return n().translator.trans("fof-impersonate.forum.modal.title")},e.content=function(){return m("div",{className:"Modal-body"},m("div",null,m("p",null,n().translator.trans("fof-impersonate.forum.modal.label",{username:h()(this.user)}))),m("div",{className:"Form Form--centered"},this.reasonEnabled?m("div",{className:"Form-group"},m("textarea",{className:"FormControl",value:this.reason(),placeholder:this.reasonRequired?n().translator.trans("fof-impersonate.forum.modal.placeholder_required"):n().translator.trans("fof-impersonate.forum.modal.placeholder_optional"),oninput:g()("value",this.reason),rows:"4"})):"",m("div",{className:"Form-group"},c().component({className:"Button Button--primary Button--block",type:"submit",loading:this.loading},n().translator.trans("fof-impersonate.forum.modal.impersonate_username",{username:h()(this.user)})))))},e.onsubmit=function(o){o.preventDefault(),this.loading=!0,n().store.createRecord("impersonate").save({userId:this.user.id(),reason:this.reason()},{errorHandler:this.onerror.bind(this)}).then(this.attrs.callback).catch((function(){}))},e.onerror=function(t){422===t.status&&(t.alert.props.children=n().translator.trans("fof-impersonate.forum.modal.placeholder_required")),this.loading=!1,o.prototype.onerror.call(this,t)},t}(p());const O=flarum.core.compat["common/extenders"];var w=o.n(O);const F=flarum.core.compat["common/models/User"];var M=o.n(F);const R=flarum.core.compat["common/Model"];var j=o.n(R),q=function(o){function t(){return o.apply(this,arguments)||this}return u(t,o),t.prototype.reason=function(){return j().attribute("reason").call(this)},t}(j());const N=[(new(w().Store)).add("impersonate",q),new(w().Model)(M()).attribute("canFoFImpersonate").attribute("impersonateReasonRequired")];n().initializers.add("fof-impersonate",(function(){(0,e.extend)(s(),"moderationControls",(function(o,t){t.canFoFImpersonate()&&o.add("fof-impersonate-login",c().component({icon:"fas fa-id-card",onclick:function(){n().modal.show(_,{callback:function(){return window.location.reload()},user:t})}},n().translator.trans("fof-impersonate.forum.user_controls.impersonate_button")))}))}))})(),module.exports=t})();
//# sourceMappingURL=forum.js.map