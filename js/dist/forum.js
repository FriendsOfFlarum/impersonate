(()=>{var o={n:t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return o.d(r,{a:r}),r},d:(t,r)=>{for(var e in r)o.o(r,e)&&!o.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:r[e]})},o:(o,t)=>Object.prototype.hasOwnProperty.call(o,t)};(()=>{"use strict";const t=flarum.core.compat["common/extend"],r=flarum.core.compat["forum/app"];var e=o.n(r);const n=flarum.core.compat["forum/utils/UserControls"];var a=o.n(n);const s=flarum.core.compat["common/components/Button"];var i=o.n(s);const c=flarum.core.compat["common/Model"];var l=o.n(c);const u=flarum.core.compat["common/models/User"];var p=o.n(u);function d(o,t){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,t){return o.__proto__=t,o},d(o,t)}function f(o,t){o.prototype=Object.create(t.prototype),o.prototype.constructor=o,d(o,t)}const h=flarum.core.compat["common/components/Modal"];var v=o.n(h);const b=flarum.core.compat["common/helpers/username"];var y=o.n(b);const _=flarum.core.compat["common/utils/Stream"];var F=o.n(_);const g=flarum.core.compat["common/utils/withAttr"];var R=o.n(g),O=function(o){function t(){return o.apply(this,arguments)||this}f(t,o);var r=t.prototype;return r.oninit=function(t){o.prototype.oninit.call(this,t),this.user=this.attrs.user,this.reason=F()(""),this.loading=!1,this.reasonEnabled=e().initializers.has("fof-moderator-notes"),this.reasonRequired=this.user.impersonateReasonRequired()},r.className=function(){return"ImpersonateModal Modal--medium"},r.title=function(){return e().translator.trans("fof-impersonate.forum.modal.title")},r.content=function(){return m("div",{className:"Modal-body"},m("div",null,m("p",null,e().translator.trans("fof-impersonate.forum.modal.label",{username:y()(this.user)}))),m("div",{className:"Form Form--centered"},this.reasonEnabled?m("div",{className:"Form-group"},m("textarea",{className:"FormControl",value:this.reason(),placeholder:this.reasonRequired?e().translator.trans("fof-impersonate.forum.modal.placeholder_required"):e().translator.trans("fof-impersonate.forum.modal.placeholder_optional"),oninput:R()("value",this.reason),rows:"4"})):"",m("div",{className:"Form-group"},i().component({className:"Button Button--primary Button--block",type:"submit",loading:this.loading},e().translator.trans("fof-impersonate.forum.modal.impersonate_username",{username:y()(this.user)})))))},r.onsubmit=function(o){o.preventDefault(),this.loading=!0,e().store.createRecord("impersonate").save({userId:this.user.id(),reason:this.reason()},{errorHandler:this.onerror.bind(this)}).then(this.attrs.callback).catch((function(){}))},r.onerror=function(t){422===t.status&&(t.alert.props.children=e().translator.trans("fof-impersonate.forum.modal.placeholder_required")),this.loading=!1,o.prototype.onerror.call(this,t)},t}(v()),q=function(o){function t(){for(var t,r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];return(t=o.call.apply(o,[this].concat(e))||this).id=l().attribute("id"),t.reason=l().attribute("reason"),t}return f(t,o),t}(l());e().initializers.add("fof-impersonate",(function(){p().prototype.canFoFImpersonate=l().attribute("canFoFImpersonate"),p().prototype.impersonateReasonRequired=l().attribute("impersonateReasonRequired"),e().store.models.impersonate=q,(0,t.extend)(a(),"moderationControls",(function(o,t){t.canFoFImpersonate()&&o.add("fof-impersonate-login",i().component({icon:"fas fa-id-card",onclick:function(){e().modal.show(O,{callback:function(){return window.location.reload()},user:t})}},e().translator.trans("fof-impersonate.forum.user_controls.impersonate_button")))}))}))})(),module.exports={}})();
//# sourceMappingURL=forum.js.map