(()=>{var o={n:t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return o.d(e,{a:e}),e},d:(t,e)=>{for(var r in e)o.o(e,r)&&!o.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},o:(o,t)=>Object.prototype.hasOwnProperty.call(o,t),r:o=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})}},t={};(()=>{"use strict";o.r(t),o.d(t,{extend:()=>k});const e=flarum.core.compat["common/extend"],r=flarum.core.compat["forum/app"];var n=o.n(r);const a=flarum.core.compat["forum/utils/UserControls"];var s=o.n(a);function i(o,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,t){return o.__proto__=t,o},i(o,t)}function c(o,t){o.prototype=Object.create(t.prototype),o.prototype.constructor=o,i(o,t)}const l=flarum.core.compat["common/app"];var u=o.n(l);const d=flarum.core.compat["common/components/Button"];var p=o.n(d);const f=flarum.core.compat["common/components/Modal"];var h=o.n(f);const v=flarum.core.compat["common/helpers/username"];var b=o.n(v);const y=flarum.core.compat["common/utils/Stream"];var g=o.n(y);const _=flarum.core.compat["common/utils/withAttr"];var w=o.n(_),O=function(o){function t(){for(var t,e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=o.call.apply(o,[this].concat(r))||this).user=void 0,t.reason=void 0,t.loading=void 0,t.reasonEnabled=void 0,t.reasonRequired=void 0,t}c(t,o);var e=t.prototype;return e.oninit=function(t){o.prototype.oninit.call(this,t),this.user=this.attrs.user,this.reason=g()(""),this.loading=!1,this.reasonEnabled=u().initializers.has("fof-moderator-notes"),this.reasonRequired=this.user.impersonateReasonRequired()},e.className=function(){return"ImpersonateModal Modal--medium"},e.title=function(){return u().translator.trans("fof-impersonate.lib.modal.title")},e.content=function(){return m("div",{className:"Modal-body"},m("div",null,m("p",null,u().translator.trans("fof-impersonate.lib.modal.label",{username:b()(this.user)}))),m("div",{className:"Form Form--centered"},this.reasonEnabled?m("div",{className:"Form-group"},m("textarea",{className:"FormControl",value:this.reason(),placeholder:this.reasonRequired?u().translator.trans("fof-impersonate.lib.modal.placeholder_required"):u().translator.trans("fof-impersonate.lib.modal.placeholder_optional"),oninput:w()("value",this.reason),rows:"4"})):"",m("div",{className:"Form-group"},p().component({className:"Button Button--primary Button--block",type:"submit",loading:this.loading},u().translator.trans("fof-impersonate.lib.modal.impersonate_username",{username:b()(this.user)})))))},e.onsubmit=function(o){var t=this;o.preventDefault(),this.loading=!0,u().store.createRecord("impersonate").save({userId:this.user.id(),reason:this.reason()}).then(this.attrs.callback).catch((function(){t.loading=!1}))},t}(h()),F=function(o){function t(){return o.apply(this,arguments)||this}c(t,o);var e=t.prototype;return e.view=function(){return m(p(),{icon:"fas fa-id-card",onclick:this.loginAsUser.bind(this)},u().translator.trans("fof-impersonate.lib.user_controls.impersonate_button"))},e.loginAsUser=function(){var o=this.attrs,t=o.user,e=o.redirectTo;u().modal.show(O,{callback:function(){e?window.location.href=e:window.location.reload()},user:t})},t}(p());const M=flarum.core.compat["common/extenders"];var R=o.n(M);const j=flarum.core.compat["common/models/User"];var N=o.n(j);const S=flarum.core.compat["common/Model"];var q=o.n(S),x=function(o){function t(){return o.apply(this,arguments)||this}return c(t,o),t.prototype.reason=function(){return q().attribute("reason").call(this)},t}(q());const P=[(new(R().Store)).add("impersonate",x),new(R().Model)(N()).attribute("canFoFImpersonate").attribute("impersonateReasonRequired")],k=[].concat(P);n().initializers.add("fof-impersonate",(function(){(0,e.extend)(s(),"moderationControls",(function(o,t){t.canFoFImpersonate()&&o.add("fof-impersonate-login",m(F,{user:t}))}))}))})(),module.exports=t})();
//# sourceMappingURL=forum.js.map