(()=>{var o={n:t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return o.d(r,{a:r}),r},d:(t,r)=>{for(var e in r)o.o(r,e)&&!o.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:r[e]})},o:(o,t)=>Object.prototype.hasOwnProperty.call(o,t),r:o=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})}},t={};(()=>{"use strict";o.r(t);const r=flarum.core.compat["common/extend"],e=flarum.core.compat["forum/app"];var n=o.n(e);const a=flarum.core.compat["forum/utils/UserControls"];var s=o.n(a);const i=flarum.core.compat["common/components/Button"];var l=o.n(i);const c=flarum.core.compat["common/Model"];var u=o.n(c);const p=flarum.core.compat["common/models/User"];var d=o.n(p);function f(o,t){return f=Object.setPrototypeOf||function(o,t){return o.__proto__=t,o},f(o,t)}function h(o,t){o.prototype=Object.create(t.prototype),o.prototype.constructor=o,f(o,t)}const b=flarum.core.compat["common/components/Modal"];var v=o.n(b);const y=flarum.core.compat["common/helpers/username"];var g=o.n(y);const _=flarum.core.compat["common/utils/Stream"];var F=o.n(_);const R=flarum.core.compat["common/utils/withAttr"];var M=o.n(R),O=function(o){function t(){return o.apply(this,arguments)||this}h(t,o);var r=t.prototype;return r.oninit=function(t){o.prototype.oninit.call(this,t),this.user=this.attrs.user,this.reason=F()(""),this.loading=!1,this.reasonEnabled=n().initializers.has("fof-moderator-notes"),this.reasonRequired=this.user.impersonateReasonRequired()},r.className=function(){return"ImpersonateModal Modal--medium"},r.title=function(){return n().translator.trans("fof-impersonate.forum.modal.title")},r.content=function(){return m("div",{className:"Modal-body"},m("div",null,m("p",null,n().translator.trans("fof-impersonate.forum.modal.label",{username:g()(this.user)}))),m("div",{className:"Form Form--centered"},this.reasonEnabled?m("div",{className:"Form-group"},m("textarea",{className:"FormControl",value:this.reason(),placeholder:this.reasonRequired?n().translator.trans("fof-impersonate.forum.modal.placeholder_required"):n().translator.trans("fof-impersonate.forum.modal.placeholder_optional"),oninput:M()("value",this.reason),rows:"4"})):"",m("div",{className:"Form-group"},l().component({className:"Button Button--primary Button--block",type:"submit",loading:this.loading},n().translator.trans("fof-impersonate.forum.modal.impersonate_username",{username:g()(this.user)})))))},r.onsubmit=function(o){o.preventDefault(),this.loading=!0,n().store.createRecord("impersonate").save({userId:this.user.id(),reason:this.reason()},{errorHandler:this.onerror.bind(this)}).then(this.attrs.callback).catch((function(){}))},r.onerror=function(t){422===t.status&&(t.alert.props.children=n().translator.trans("fof-impersonate.forum.modal.placeholder_required")),this.loading=!1,o.prototype.onerror.call(this,t)},t}(v()),q=function(o){function t(){for(var t,r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];return(t=o.call.apply(o,[this].concat(e))||this).id=u().attribute("id"),t.reason=u().attribute("reason"),t}return h(t,o),t}(u());n().initializers.add("fof-impersonate",(function(){d().prototype.canFoFImpersonate=u().attribute("canFoFImpersonate"),d().prototype.impersonateReasonRequired=u().attribute("impersonateReasonRequired"),n().store.models.impersonate=q,(0,r.extend)(s(),"moderationControls",(function(o,t){t.canFoFImpersonate()&&o.add("fof-impersonate-login",l().component({icon:"fas fa-id-card",onclick:function(){n().modal.show(O,{callback:function(){return window.location.reload()},user:t})}},n().translator.trans("fof-impersonate.forum.user_controls.impersonate_button")))}))}))})(),module.exports=t})();
//# sourceMappingURL=forum.js.map